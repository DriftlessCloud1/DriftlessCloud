# XSS exploits
Learning about XSS exploits.

- XSS (Cross-Site Scripting) is a vulnerability allowing attackers to inject harmful scripts into web content viewed by other users.
- XSS targets users of a website rather than the server itself, utilizing the server to deliver malicious content.
- Example: A trusted site inadvertently publishes a malicious script, misleading users to perform actions like transferring money.

- XSS vulnerabilities arise when a web application:
- Accepts user input (from forms, URL parameters, etc.).
- Fails to properly sanitize the input (doesnâ€™t filter or encode unsafe characters).
- Outputs that unsanitized input in its rendered HTML.

- This oversight violates the security principle of treating all user input as untrusted.

- The three primary types of XSS:
1. **Reflected XSS**
- Mechanism: The script is reflected off a web server, executed immediately via crafted URLs.
- Exploitation: Victims are tricked into clicking on modified links.
- Analogy: Harming someone only occurs when they open a dangerous document.
- Example URL: `http://vulnerable-site.com/search?q=`

2. **Stored XSS**
- Mechanism: The script is stored on a server (in databases, comments) and served to all page visitors.
- Exploitation: More severe, as victims need only visit the compromised page without clicking on links.
- Analogy: Poisoning a town's water supply.
- Example: Malicious script within a blog comment is executed for every visitor.

3. **DOM-based XSS**
- Mechanism: Exists in client-side JavaScript, where the client-side script processes unsanitized input.
- Exploitation: Similar to Reflected XSS but with server responses unchanged; relies on faulty client-side logic.
- Example: URL `http://site.com#` triggers the alert.

- Ethical Testing Methodology:
**Phase 1: Reconnaissance & Discovery**
- Map out all user input points including search fields, forms, URL parameters.
- Probe with harmless payloads and observe HTML output using browser DevTools.

**Phase 2: Verification & Context Analysis**
- Understand where input is inserted:
- Inside HTML Tags: Break out of tags.
- Inside HTML Attributes: Close the tag and attribute.
- Inside JavaScript: Exit the string context.

**Phase 3: Proof-of-Concept (PoC) Exploitation**
- Basic PoC: `alert(document.domain)` to indicate vulnerability presence.
- More advanced PoCs can demonstrate serious impacts (cookie stealing or keylogging).

**Phase 4: Reporting & Remediation**
- Document vulnerable URLs, payloads used, reproduction steps.
- Prioritize risks: Stored XSS > Reflected XSS.
- Suggest clear remediation measures, focusing on output encoding, input validation, and the use of modern frameworks with built-in protection.

- The importance of Content Security Policy (CSP) as a protective measure enhances security against XSS.

- XSS remains a prevalent web vulnerability, reflecting challenges in output handling.
- Developers should adhere to the principle of not trusting user input to mitigate XSS risks effectively.
- Ethical hackers must contextualize and highlight real-world impacts while educating development teams for comprehensive fixes.
